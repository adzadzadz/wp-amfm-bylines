(function(e){"use strict";e(document).ready(function(){e("#amfm-create-staff").on("click",function(){window.location.href="/wp-admin/post-new.php?post_type=staff"}),e(".amfm-card").on("click",function(){if(e(this).hasClass("amfm-card-staff-item")){var a=e(this).data("url");window.location.href=a;return}if(e(this).attr("id")==="amfm-create-card"){e("#amfmDrawer .drawer-title").text("Create New Byline"),e("#amfmDrawer").addClass("open"),e("#amfm-bylines-form")[0].reset();return}var t=e(this).find(".card-title").text();e("#amfmDrawer .drawer-title").text(t),e("#amfmDrawer").addClass("open")}),e("#closeDrawer").on("click",function(){e("#amfmDrawer").removeClass("open")}),e(document).on("click",function(a){e(a.target).closest("#amfmDrawer, .amfm-card, .media-modal").length||e("#amfmDrawer").removeClass("open")})}),e(document).ready(function(){var a=e("#wpadminbar"),t=e("#amfmDrawer");if(a.length){var r=a.outerHeight();t.css({top:r+"px",height:"calc(100% - "+r+"px)"})}}),e(document).ready(function(a){a("#upload_image_button").on("click",function(t){t.preventDefault();var r;if(r){r.open();return}r=wp.media({title:"Select or Upload Media",button:{text:"Use this media"},multiple:!1}),r.on("select",function(){var i=r.state().get("selection").first().toJSON();a("#image_url").val(i.url)}),r.open()})}),e(document).ready(function(a){function t(){a.ajax({url:amfmLocalize.ajax_url,method:"GET",data:{action:"fetch_pages",nonce:amfmLocalize.pageSelectorNonce},success:function(r){if(r.success){var i=r.data,o=a("#page_selector");o.empty(),o.append('<option value="">Select a page</option>'),a.each(i,function(s,n){console.log(n),o.append('<option value="'+n.link+'">'+n.title+"</option>")})}}})}a("#page_selector").on("change",function(){var r=a(this).val();a("#page_url").val(r)})}),e(document).ready(function(a){a("#amfm-bylines-form").on("submit",function(t){t.preventDefault();var r=a(this).serialize(),i=a("#name").val().trim();if(i===""){var o=a('<div class="flash-message error"></div>').text("Name is required.");a("#flash-message-container").html(o),setTimeout(function(){o.fadeOut(function(){a(this).remove()})},5e3);return}a.ajax({url:amfmLocalize.ajax_url,method:"POST",data:{action:"save_amfm_bylines",nonce:amfmLocalize.saveBylineNonce,form_data:r},success:function(s){var n=a('<div class="flash-message"></div>');s.success?(n.text("Data saved successfully!").addClass("success"),a("#amfm-bylines-form")[0].reset(),location.reload()):n.text("There was an error saving the data.").addClass("error"),a("#flash-message-container").html(n),a("#amfmDrawer").removeClass("open"),setTimeout(function(){n.fadeOut(function(){a(this).remove()})},5e3)},error:function(s){var n=a('<div class="flash-message error"></div>');s.status===403?n.text("Unauthorized request. Please refresh the page and try again."):n.text("There was an error processing the request."),a("#flash-message-container").html(n),setTimeout(function(){n.fadeOut(function(){a(this).remove()}),a("#amfmDrawer").removeClass("open")},5e3)}})})}),e(document).ready(function(){e(".amfm-card-item").on("click",function(){var a=e(this).data();if(e("#name").val(a.name),e("#image_url").val(a.image),e("#description").val(a.description),e("#byline_id").val(a.id),a.data){console.log(a.data);var t=a.data;e("#page_url").val(t.page_url),e("#honorificSuffix").val(t.honorificSuffix),e("#jobTitle").val(t.jobTitle),e("#credentialType").val(t.hasCredential["@type"]),e("#credentialName").val(t.hasCredential.name),e("#worksForType").val(t.worksFor["@type"]),e("#worksForName").val(t.worksFor.name)}e("#authorTag").val(a.authorTag),e("#editorTag").val(a.editorTag),e("#reviewedByTag").val(a.reviewedByTag),e("#amfmDrawer").addClass("open"),e('#amfm-bylines-form button[type="reset"]').hide(),e('#amfm-bylines-form button[type="submit"]').text("Save"),e("#amfm-remove-byline").show()}),e("#amfm-create-card").on("click",function(){e("#amfm-bylines-form")[0].reset(),e("#byline_id").val(""),e('#amfm-bylines-form button[type="reset"]').show(),e('#amfm-bylines-form button[type="submit"]').text("Submit"),e("#amfm-remove-byline").hide()})}),e(document).ready(function(){e("#amfm-remove-byline").on("click",function(){var a=e("#byline_id").val();console.log("STARTS"),console.log(amfmLocalize),console.log(a),a&&confirm("Are you sure you want to delete this byline?")&&e.ajax({url:amfmLocalize.ajax_url,method:"POST",data:{action:"remove_amfm_byline",nonce:amfmLocalize.removeBylineNonce,id:a},success:function(t){t.success?location.reload():alert("There was an error deleting the byline.")},error:function(t){t.status===403?alert("Unauthorized request. Please refresh the page and try again."):alert("There was an error processing the request.")}})})}),e(document).ready(function(){e("#functionToggle").change(function(){var a=e(this).is(":checked");e.ajax({url:ajaxurl,type:"POST",data:{action:"toggle_function",is_active:a},success:function(t){alert("Function "+(a?"activated":"deactivated")+" successfully.")},error:function(t,r,i){alert("An error occurred: "+i)}})})})})(jQuery);
